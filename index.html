<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="./img/favicon-mc.ico">
    <!-- 最新編譯和最佳化的 CSS -->
    <link href="./css/bootstrap.min.css" rel="stylesheet" />    

    <!-- Custom styles for this template -->
    <link href="./css/sticky-footer.css" rel="stylesheet" />            
    
    <link href="./css/starter-template.css" rel="stylesheet" />
    <!--[if lt IE 9]>
    <script src="../Scripts/ie8-responsive-file-warning.js"></script>    
    <![endif]-->
    <script src="./Scripts/ie-emulation-modes-warning.js"></script>
    
    
    <!--[if lt IE 9]>
    <script src="../Scripts/html5shiv.min.js"></script>
    <script src="../Scripts/respond.min.js"></script>
    <![endif]-->

    <style>
        .append_a {
            padding-right:5px;
            padding-left: 15px;
        }

        .append_d {
            padding-right:20px;
        }
    </style>
    <script src="./jquery/jquery.min.js"></script>
    <script src="./Scripts/fullLarmData.js"></script>

    <title></title>
    <script>
        var vDailyLamID = arrayDailyLamID;
        var vDailyLamFile = arrayDailyLamFile;
        function DoPaly()
        {
            var audio = document.getElementById("MyAudio");
            var source = document.getElementById('MySource');

            //目前挑選的音檔來源
            var now_source = document.getElementById("tbxTargetURL").value;

            //如果音檔來源空白，停止進行
            if (now_source == '') {
                alert('請先輸入音檔來源!');
                return false;
            }

            source.src = document.getElementById('tbxTargetURL').value;



            audio.load();
            audio.play();
        }

        function DoRecord() {
            var audio = document.getElementById("MyAudio");
            var vCurrentTime = new Number(audio.currentTime);

            var vAppend = "<a class='append_a t_" + vCurrentTime.toString().replace(".", "_") + "' href='javascript:SetTime(" + vCurrentTime.toFixed(2) + ")'>" + formatSecond(vCurrentTime) + "</a><a class='append_d t_" + vCurrentTime.toString().replace(".", "_") + "' href='javascript:DoDelete(\"t_" + vCurrentTime.toString().replace(".", "_") + "\")' title='刪除'><span style='color:red' class='glyphicon glyphicon-trash'> </span></a>";
            $("#RecordList").append(vAppend);
            //console.log('curren time', audio.currentTime);
            
        }

        function SetTime(vTime) {
            var audio = document.getElementById('MyAudio');
            audio.currentTime = vTime;
        }

        function formatSecond(secs) {
            var hr = Math.floor(secs / 3600);
            var min = Math.floor((secs - (hr * 3600)) / 60);
            var sec = parseInt(secs - (hr * 3600) - (min * 60));

            while (min.length < 2) { min = '0' + min; }
            while (sec.length < 2) { sec = '0' + min; }
            if (hr) hr += ':';
            return hr + min + ':' + sec;

        }

        function DoDelete(vClass)
        {
            vConfirm = confirm('是否確定要刪除此紀錄?');

            if (!vConfirm)
                return false;

            $("." + vClass).remove();
        }

        function DoLamAdd()
        {
            vBook = $("#tbxBook").val();
            vAB = $('input[name=optradio]:checked').val();

            if (vBook == "")
            {
                alert("請先輸入第幾冊!");
                return false;
            }
            var vLink = "https://theqi.com/buddhism/GL1/audio/" + vBook + vAB.toUpperCase() + ".MP3";
            $("#tbxTargetURL").val(vLink);
        }

        function DoLamRead() {
            vBook = $("#tbxBook").val();
            vAB = $('input[name=optradio]:checked').val();

            if (vBook == "") {
                alert("請先輸入第幾冊!");
                return false;
            }
            var vLink = "https://theqi.com/buddhism/GL1/data/s" + vBook + vAB.toLowerCase() + ".html";
            window.open(vLink, "_blank");
        }

        function DoNSLAdd()
        {
            vOriBook = '0'+$("#tbxNSLBook").val();


            vBook = vOriBook.substr(vOriBook.length - 2, 2);
            vAB = $('input[name=NSLoptradio]:checked').val();

            if ($("#tbxNSLBook").val() == "") {
                alert("請先輸入第幾冊!");
                return false;
            }
            var vLink = "https://www.theqi.com/buddhism/NSL/NSL_" + vBook + vAB.toUpperCase() + ".mp3";
            $("#tbxTargetURL").val(vLink);
        }

        function DoNSLRead()
        {
            vOriBook = '0' + $("#tbxNSLBook").val();


            vBook = vOriBook.substr(vOriBook.length - 2, 2);
            vAB = $('input[name=NSLoptradio]:checked').val();

            if ($("#tbxNSLBook").val() == "") {
                alert("請先輸入第幾冊!");
                return false;
            }
            var vLink = "https://www.theqi.com/buddhism/NSL/data/p" + vBook + vAB.toLowerCase() + ".html";
            window.open(vLink, "_blank");
        }

        function DoDailyAdd()
        {
            var vLink = $("select option:selected").val();            
            $("#tbxTargetURL").val(vLink);

        }

        function DoLarmRead()
        {
            var vUserInput=$.trim($("#tbxPageNum").val());
            if(isNaN(vUserInput))
            {
                alert('請輸入正確的頁數');
                return;
            }

            var iNum=parseInt(vUserInput);
            var iPageNum=iNum+22;
            var vTmp="0000"+iPageNum.toString();
            var vPage="https://raw.githubusercontent.com/paladinlee/larmimg/master/page"+vTmp.substr(vTmp.length-4,4)+".jpg";
            window.open(vPage,"_blank");

        }

        $(function () {
            for (var i = 0; i < vDailyLamID.length; i++)
            {
                $("#sel1").append($("<option></option>").attr("value", vDailyLamFile[i]).text(vDailyLamID[i]));
            }

        });
    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div class="container">  
    <div class="row">
    <script>
      (function() {
        var cx = '002047481276774726341:uqalit40df4';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:search></gcse:search>
    </div>  

    <div class="row">
        <div class="col-md-4">
            <div class="input-group">
                <span class="input-group-addon">【廣論】冊</span>
                <input type="text" id="tbxBook" class="form-control" />
            </div>
        </div>
        <div class="col-md-4">
            <div class="input-group">
                <span class="input-group-addon">AB</span>
                    <span class="form-control">
                      <label><input type="radio" name="optradio" value="A" checked >A</label>                   
                      <label><input type="radio" name="optradio" value="B">B</label>
                   </span>
            </div>
        </div>
        <div class="col-md-4">
            <div class="input-group">
                <div >
                    <input type="button" value="加入" id="btnLamAdd" class="btn btn-primary " onclick="DoLamAdd()"  /> 
                    <input type="button" value="閱讀" id="btnRead" class="btn btn-primary " onclick="DoLamRead()"  /> 
                </div>
                   
            </div>
        </div>
    </div>        
        <br />
<div class="row">
        <div class="col-md-4">
            <div class="input-group">
                <span class="input-group-addon">【備覽】冊</span>
                <input type="text" id="tbxNSLBook" class="form-control" />
            </div>
        </div>
        <div class="col-md-4">
            <div class="input-group">
                <span class="input-group-addon">AB</span>
                    <span class="form-control">
                      <label><input type="radio" name="NSLoptradio" value="A" checked >A</label>                   
                      <label><input type="radio" name="NSLoptradio" value="B">B</label>
                   </span>
            </div>
        </div>
        <div class="col-md-4">
            <div class="input-group">
                <span >
                    <input type="button" value="加入" id="btnNSLAdd" class="btn btn-primary " onclick="DoNSLAdd()"  /> 
                    <input type="button" value="閱讀" id="btnNSLRead" class="btn btn-primary " onclick="DoNSLRead()"  /> 
                </span>
                   
            </div>
        </div>
    </div>            
        <br />

    <div class="row">
       <div class="col-md-6">
            <div class="input-group">
              <span class="input-group-addon">全廣 II</span>
              <select class="form-control" id="sel1">               
              </select>
            </div> 
       </div>
        <div class="col-md-6">
            <div class="input-group">
                <span >
                    <input type="button" value="加入" id="btnDailyAdd" class="btn btn-primary form-control" onclick="DoDailyAdd()"  />                     
                </span>
                
                   
            </div>
        </div>
    </div>
        <br />
        <div class="row">
            <div class="col-md-6">
                 <div class="input-group">
                   <span class="input-group-addon">廣論頁數</span>
                   <input type="text" id="tbxPageNum" class="form-control">        
                   </select>
                 </div> 
            </div>
             <div class="col-md-6">
                 <div class="input-group">                        
                     <span >
                         
                         <input type="button" value="開啟" id="btnLarmRead" class="btn btn-primary form-control" onclick="DoLarmRead()"  />                     
                     </span>
                     
                        
                 </div>
             </div>
         </div>    
        <br />
    <div class="row">
        <div class="col-md-12">
             <div class="input-group">
                 <span class="input-group-addon"><span style="color:red">*</span> Target URL</span>
                 <input type="text" id="tbxTargetURL" class="form-control" />                                 
             </div>
        </div>
    </div>
        <br />
    <div class="btn-group" role="group" arial-label="..." style="padding-bottom:5px;">        
        <input type="button" value="播放" id="btnPlay" class="btn btn-primary" onclick="DoPaly()"  />        
    </div>
    <div class="btn-group" role="group" arial-label="..." style="padding-bottom:5px;">        
        <input type="button" value="記憶" id="btnRecord" class="btn btn-danger" onclick="DoRecord()"  />        
    </div>
    <div class="btn-group" role="group" arial-label="..." style="padding-bottom:5px;">        
        <span id="RecordList"></span>       
    </div>
    <div class="row">
        <div class="col-md-12">
            <audio id="MyAudio" controls class="form-control">              
              <source id="MySource" src="" type="audio/mpeg">
            Your browser does not support the audio element.
            </audio>            
        </div>
    </div>
   
  
       
       

        
    </div>
    </form>
</body>
</html>